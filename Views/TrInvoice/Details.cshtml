@model InvoiceApp.Models.TrInvoice
@{
    ViewData["Title"] = "Invoice Details";
}

<h2>Invoice Details</h2>

<div>
    <h4>Invoice #: <strong>@Model.InvoiceNo</strong></h4>
    <hr />
    <dl class="row">
        <dt class="col-sm-2">Date</dt>
        <dd class="col-sm-10">@Model.InvoiceDate.ToString("yyyy-MM-dd HH:mm")</dd>

        <dt class="col-sm-2">Invoice To</dt>
        <dd class="col-sm-10">@Model.InvoiceTo</dd>

        <dt class="col-sm-2">Ship To</dt>
        <dd class="col-sm-10">@Model.ShipTo</dd>

        <dt class="col-sm-2">Sales</dt>
        <dd class="col-sm-10">@Model.Sales?.SalesName</dd>

        <dt class="col-sm-2">Courier</dt>
        <dd class="col-sm-10">@Model.Courier?.CourierName</dd>

        <dt class="col-sm-2">Payment</dt>
        <dd class="col-sm-10">@Model.Payment?.PaymentName</dd>
    </dl>
</div>

<hr />

<h4>Product Details</h4>

<table class="table table-bordered">
    <thead>
        <tr>
            <th>Product</th>
            <th>Weight</th>
            <th>Qty</th>
            <th>Price</th>
            <th>Subtotal</th>
        </tr>
    </thead>
    <tbody>
        @if (Model.InvoiceDetails != null && Model.InvoiceDetails.Any())
        {
            decimal total = 0;
            foreach (var detail in Model.InvoiceDetails)
            {
                var subtotal = detail.Qty * detail.Price;
                total += subtotal;
                <tr>
                    <td>@detail.Product?.ProductName</td>
                    <td>@detail.Weight</td>
                    <td>@detail.Qty</td>
                    <td>@detail.Price.ToString("N0")</td>
                    <td>@subtotal.ToString("N0")</td>
                </tr>
            }
            <tr>
                <td colspan="4" class="text-end"><strong>Courier Fee</strong></td>
                <td>@Model.CourierFee.ToString("N0")</td>
            </tr>
            <tr>
                <td colspan="4" class="text-end"><strong>Grand Total</strong></td>
                <td>@(total + Model.CourierFee).ToString("N0")</td>
            </tr>
        }
        else
        {
            <tr>
                <td colspan="5">No products found in this invoice.</td>
            </tr>
        }
    </tbody>
</table>

<div>
    <a asp-action="Edit" asp-route-id="@Model.InvoiceNo" class="btn btn-warning">Edit</a>
    <a asp-action="Index" class="btn btn-secondary">Back to List</a>
</div>
